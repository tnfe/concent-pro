(this["webpackJsonpconcent-pro"]=this["webpackJsonpconcent-pro"]||[]).push([[3],{993:function(e,t,n){"use strict";n.r(t),n.d(t,"setup",(function(){return A}));var a={};n.r(a),n.d(a,"doubleCount",(function(){return v}));var r={};n.r(r),n.d(r,"modTableMeta",(function(){return x})),n.d(r,"handlePageCurrentChange",(function(){return C})),n.d(r,"handleNextPage",(function(){return w})),n.d(r,"handlePageSizeChange",(function(){return T})),n.d(r,"clearTable",(function(){return z})),n.d(r,"fetchTableData",(function(){return E}));var o={};n.r(o),n.d(o,"mounted",(function(){return O})),n.d(o,"willUnmount",(function(){return P}));var c=n(1),i=n.n(c),u=n(968),l=n(58),d=n(210),s=n(18),h=n.n(s),f=n(38),p=n(14),m=n(756);function g(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return{lockId:"init_lock",hasMoreMode:e,hasMore:!0,current:1,pageSize:t,total:0,list:[],loading:!1}}var b=function(){return{meta:{}}};function v(e){}var I=n(80);function k(e,t){return I.h(e,t,g())}function x(e,t){var n=e.tableId,a=e.toMod,r=t.meta,o=k(r,n);return I.e(a.pageSize)&&"number"!==typeof a.pageSize&&(a.pageSize=parseInt(a.pageSize,10)),I.g(o,a),{meta:r}}function C(e,t,n){return S.apply(this,arguments)}function S(){return(S=Object(f.a)(h.a.mark((function e(t,n,a){var r,o,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.current,o=t.tableId,c=t.fetchFn,e.next=3,a.dispatch(x,{tableId:o,toMod:{loading:!0,current:r,lockId:Date.now()}});case 3:return e.next=5,a.dispatch(E,{tableId:o,fetchFn:c});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,n){return y.apply(this,arguments)}function y(){return(y=Object(f.a)(h.a.mark((function e(t,n,a){var r,o,c,i,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.tableId,o=t.fetchFn,c=n.meta,i=k(c,r),u=i.current,e.next=5,a.dispatch(C,{current:u+1,tableId:r,fetchFn:o});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t,n){return M.apply(this,arguments)}function M(){return(M=Object(f.a)(h.a.mark((function e(t,n,a){var r,o,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.tableId,o=t.pageSize,c=t.fetchFn,e.next=3,a.dispatch(x,{tableId:r,toMod:{loading:!0,pageSize:o,lockId:Date.now()}});case 3:return e.next=5,a.dispatch(E,{tableId:r,fetchFn:c});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t,n){var a=e.tableId;n.dispatch(x,{tableId:a,toMod:{list:[],total:0,loading:!1}})}function E(e,t,n){return F.apply(this,arguments)}function F(){return(F=Object(f.a)(h.a.mark((function e(t,n,a){var r,o,c,i,u,l,d,s,f,p,m,g,b,v,I,C,S,w,y;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.tableId,o=t.fetchFn,c=n.meta,i=k(c,r),u=i.current,l=i.pageSize,d=i.lockId,s=i.list,f=i.hasMoreMode,e.next=5,o({current:u,pageSize:l,list:s});case 5:if(p=e.sent){e.next=10;break}return e.next=9,a.dispatch(x,{tableId:r,toMod:{loading:!1}});case 9:return e.abrupt("return");case 10:if(m=p.pageList,g=p.page_list,b=p.total,v=void 0===b?0:b,I=p.hasMore,C=void 0===I||I,S=m||g||[],k(c,r).lockId===d){e.next=14;break}return e.abrupt("return");case 14:return w=(u-1)*l,S.forEach((function(e,t){e&&(e.__seq=w+(t+1))})),y=S,f&&(y=s.concat(S)),e.next=20,a.dispatch(x,{tableId:r,toMod:{list:y,total:v,hasMore:C,loading:!1}});case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){}function P(e){}var j={state:b,computed:a,reducer:r,lifecycle:o},L=Object(p.a)({},"GeneralTable",j),B=Object(m.makeUseModelWithSetup)("GeneralTable"),D=(Object(m.makeUseModelWithSetupCuf)("GeneralTable"),Object(m.makeUseModel)("GeneralTable"),L),N=n(39);Object(N.configure)(D);var U=n(990),V=n(967),G=function(e){var t=e.props,n=t.tid,a=t.fetchAfterMounted,r=void 0===a||a,o=t.hasMoreMode,c=void 0!==o&&o,i=t.fetchFn,u=t.pageSizeOptions,l=void 0===u?["50","100","200"]:u,d=e.ccUniqueKey;if(!e.state.meta[n]){var s=parseInt(l[0],10)||50;e.state.meta[n]=g(c,s)}e.on(["refreshTable",n],function(){var t=Object(f.a)(h.a.mark((function t(a){var r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a||i,t.next=3,e.mr.clearTable({tableId:n},d);case 3:return t.next=5,e.mr.handlePageCurrentChange({tableId:n,current:1,fetchFn:r},d);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.on(["clearTable",n],(function(){e.mr.clearTable({tableId:n},d)})),e.on(["refreshTableCurPage",n],(function(t){var a=t||i,r=e.state.meta[n];e.mr.handlePageCurrentChange({tableId:n,current:r.current,fetchFn:a},d)})),e.effect((function(){return r&&p(1),function(){return e.dispatch("clearTable",{tableId:n},d)}}),[]);var p=function(t){if(e.state.meta[n].current!==t){var a=e.props.fetchFn;e.mr.handlePageCurrentChange({tableId:n,current:t,fetchFn:a},d)}};return{handlePageCurrentChange:p,handelPageSizeChange:function(t,a){var r=e.props.fetchFn;e.mr.handlePageSizeChange({tableId:n,pageSize:a,fetchFn:r},d)},handleNextPage:function(){var t=e.props.fetchFn;e.mr.handleNextPage({tableId:n,fetchFn:t},d)},pageSizeOptions:l}};var _=i.a.memo((function(e){var t=B(G,{props:e}),n=t.state,a=t.settings,r=e.tid,o=e.columns,u=e.rowKey,l=void 0===u?"id":u,s=e.scroll,h=void 0===s?{x:"100%"}:s,f=e.hasMoreMode,p=void 0!==f&&f,m=e.disableBtnWhenNoMore,g=e.size,b=n.meta[r],v=b.list,I=b.loading,k=b.current,x=b.total,C=b.pageSize,S=b.hasMore,w=a.handelPageSizeChange,y=a.handlePageCurrentChange,T=a.handleNextPage,M=a.pageSizeOptions;return i.a.createElement(c.Fragment,null,i.a.createElement(U.a,{rowKey:l,columns:o,dataSource:v,size:g,loading:I,pagination:!1,scroll:h}),i.a.createElement("div",{style:{height:"19px",width:"100%"}}),p?m&&!S?i.a.createElement(d.a,{disabled:!0,style:{width:"100%"}},"\u6ca1\u6709\u66f4\u591a\u4e86"):i.a.createElement(d.a,{onClick:T,style:{width:"100%"}},"\u52a0\u8f7d\u66f4\u591a"):i.a.createElement(V.a,{onShowSizeChange:w,onChange:y,current:k,total:x,showSizeChanger:!0,pageSizeOptions:M,pageSize:C}))}));function K(e){var t=e.mr;return{columns:[{key:"id",dataIndex:"id",title:"id"},{key:"text",dataIndex:"text",title:"\u6587\u6848"},{key:"done",dataIndex:"done",title:"\u662f\u5426\u5b8c\u6210",render:function(e){return e?"done":"uncomplish"}}],refreshTable:function(){e.emit(["refreshTable","todoTable"])},fetchList:function(e){return t.fetchList(e)},test:function(){e.setModuleState("TodoList",{value:Date.now()},(function(){}),null,500)}}}var W=i.a.memo((function(){var e=Object(l.e)("TodoList",{setup:K}),t=e.settings,n=e.state;return i.a.createElement("div",null,i.a.createElement(d.a,{id:"refreshBtn",onClick:t.refreshTable},"refresh"),i.a.createElement(d.a,{id:"refreshBtn",onClick:t.test},"test ",n.value),i.a.createElement(_,{tid:"todoTable",columns:t.columns,fetchFn:t.fetchList}))})),q=n(992);var J=i.a.memo((function(){var e=Object(l.e)("TodoList"),t=e.sync,n=e.syncer,a=e.state,r=e.mr;return i.a.createElement("div",null,i.a.createElement(q.a,{onChange:t("keyword"),value:a.keyword}),i.a.createElement(q.a,{onChange:n.keyword,value:a.keyword}),i.a.createElement("span",{id:"bigValue"},a.bigValue),i.a.createElement(d.a,{id:"addBigBtn",onClick:r.addBig}))}));function A(e){return{hiThere:function(){return"hiThere"},changeBigTo:function(t){e.setState({bigValue:t})}}}var H=i.a.memo((function(){var e=Object(l.e)("TodoList").state;return i.a.createElement("h1",{style:{border:"1px solid blue"}},e.value)}));t.default=i.a.memo((function(){var e=Object(l.e)("TodoList",{setup:A,tag:"Dpt"}),t=e.moduleComputed,n=e.state;return i.a.createElement("div",null,i.a.createElement(u.a,{message:t.formattedInput}),i.a.createElement("h1",{id:"bigValue"},n.bigValue),i.a.createElement(J,null),i.a.createElement(H,null),i.a.createElement(H,null),i.a.createElement(W,null))}))}}]);
//# sourceMappingURL=3.519c4ec2.chunk.js.map